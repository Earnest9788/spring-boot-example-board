<!DOCTYPE html>
<html 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorator="layouts/main_layout"
>
<head>
    <title>글쓰기</title>
</head>

    <th:block layout:fragment="css">
        <link rel="stylesheet" th:href="@{/css/pages/article/write.css}" >
    </th:block>
    <th:block layout:fragment="script">
        <script th:src="@{/js/ckeditor5/ckeditor.js}"></script>
        <script>
            // window.onload = () => {
            //     ClassicEditor
            //     .create( document.querySelector( '#ckEditor' ) )
            //     .catch( error => {
            //         console.error( error );
            //     } );
            // }           
        </script>    
    </th:block>

    <main class="write" layout:fragment="content">
        
        <form th:action="${article != null} ? @{/api/article/update(keyIdx=${article.keyIdx})} : '/api/article/regist'" method="POST">
            <fieldset>
                <label>제목</label>
                <input type="text" name="title" th:value="${article != null} ? ${article.title} : ''">
            </fieldset>
            <fieldset>
                <label>내용</label>
                <div></div>
                <textarea id="ckEditor" name="content" cols="30" rows="10" th:text="${article != null} ? ${article.content} : ''"></textarea>            
            </fieldset>
            <fieldset>
                <input class="submit_btn" type="submit" th:value="${article != null} ? '수정' : '작성'">
            </fieldset>
        </form>
        <div class="error_box" th:if="${#httpServletRequest.getParameter('fail')}">
            <div>요청에 실패했습니다. 내용을 모두 입력해주세요.</div>
        </div>
    </main>     
</html>